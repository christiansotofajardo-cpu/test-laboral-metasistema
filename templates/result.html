<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Resultados — Test Laboral MetaSistema</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">

    <div class="card">
      <h1>Resultados</h1>
      <div class="small">
        Test Laboral MetaSistema — IPIP-100 + Producción escrita (TRU-sensible)
      </div>
    </div>

    <div class="card">
      <h2>IPIP-100 (resumen)</h2>

      <div class="small">Promedios por factor</div>
      <ul>
        <li><b>CON</b> ({{ factor_labels["CON"] }}): {{ avg_scores["CON"] }}</li>
        <li><b>NEU</b> ({{ factor_labels["NEU"] }}): {{ avg_scores["NEU"] }}</li>
        <li><b>EXT</b> ({{ factor_labels["EXT"] }}): {{ avg_scores["EXT"] }}</li>
        <li><b>AGR</b> ({{ factor_labels["AGR"] }}): {{ avg_scores["AGR"] }}</li>
        <li><b>OPE</b> ({{ factor_labels["OPE"] }}): {{ avg_scores["OPE"] }}</li>
      </ul>
    </div>

    <div class="card">
      <h2>Producción escrita (TRU-sensible)</h2>

      {% set sf = analisis_discursivo["scores_sensibles"]["funcional"] %}
      {% set ss = analisis_discursivo["scores_sensibles"]["situacional"] %}
      {% set sg = analisis_discursivo["scores_sensibles"]["global_promedio"] %}

      <h3>Score global</h3>
      <p><b>{{ sg if sg is not none else "—" }}</b></p>

      <h3>Funcional</h3>
      <ul>
        <li>Coherencia: <b>{{ sf["coherencia"] }}</b></li>
        <li>Relevancia: <b>{{ sf["relevancia"] }}</b></li>
        <li>Registro: <b>{{ sf["registro"] }}</b></li>
        <li>Desarrollo: <b>{{ sf["desarrollo"] }}</b></li>
        <li>Tono (alerta suave): <b>{{ sf["alerta_emocion"] }}</b></li>
        <li>Global funcional: <b>{{ sf["global"] }}</b></li>
      </ul>

      <h3>Situacional</h3>
      <ul>
        <li>Coherencia: <b>{{ ss["coherencia"] }}</b></li>
        <li>Relevancia: <b>{{ ss["relevancia"] }}</b></li>
        <li>Registro: <b>{{ ss["registro"] }}</b></li>
        <li>Desarrollo: <b>{{ ss["desarrollo"] }}</b></li>
        <li>Tono (alerta suave): <b>{{ ss["alerta_emocion"] }}</b></li>
        <li>Global situacional: <b>{{ ss["global"] }}</b></li>
      </ul>

      <div class="small">
        Nota: esto todavía no “prueba MetaSistema”; es agrupación estética y funcional de índices sensibles.
      </div>
    </div>

    <div class="card">
      <h2>Diagnóstico técnico</h2>
      <div class="small">
        TRUNAJOD endpoint configurado: <b>{{ analisis_discursivo["meta"]["trunajod_endpoint_configurado"] }}</b><br/>
        TRUNAJOD ok (funcional): <b>{{ analisis_discursivo["meta"]["trunajod_ok_funcional"] }}</b><br/>
        TRUNAJOD ok (situacional): <b>{{ analisis_discursivo["meta"]["trunajod_ok_situacional"] }}</b>
      </div>

      {% if analisis_discursivo["meta"]["trunajod_error_funcional"] or analisis_discursivo["meta"]["trunajod_error_situacional"] %}
        <pre>{{ analisis_discursivo["meta"] }}</pre>
      {% endif %}
    </div>

    <div class="card">
      <a href="/test">Volver al test</a>
    </div>

  </div>
</body>
</html>
